{"version":3,"file":"Giscus.js","sources":["../../../src/client/components/Giscus.ts"],"sourcesContent":["import type { VNode } from \"vue\";\nimport { computed, defineComponent, h, onMounted, ref } from \"vue\";\nimport { usePageLang } from \"vuepress/client\";\nimport { LoadingIcon } from \"vuepress-shared/client\";\n\nimport type {\n  GiscusInputPosition,\n  GiscusMapping,\n  GiscusRepo,\n  GiscusTheme,\n} from \"../../shared/index.js\";\nimport { useGiscusOptions } from \"../helpers/index.js\";\n\nimport \"../styles/giscus.scss\";\n\n// Note: Should be updated with https://github.com/giscus/giscus/tree/main/locales\nconst SUPPORTED_LANGUAGES = [\n  \"ar\",\n  \"ca\",\n  \"de\",\n  \"en\",\n  \"eo\",\n  \"es\",\n  \"fa\",\n  \"fr\",\n  \"he\",\n  \"id\",\n  \"it\",\n  \"ja\",\n  \"ko\",\n  \"nl\",\n  \"pl\",\n  \"pt\",\n  \"ro\",\n  \"ru\",\n  \"th\",\n  \"tr\",\n  \"uk\",\n  \"vi\",\n  \"zh-CN\",\n  \"zh-TW\",\n] as const;\n\ntype BooleanString = \"0\" | \"1\";\n\nexport type GiscusLang = (typeof SUPPORTED_LANGUAGES)[number];\n\nexport type GiscusLoading = \"lazy\" | \"eager\";\n\nexport interface GiscusProps {\n  id?: string | undefined;\n  repo: GiscusRepo;\n  repoId: string;\n  category?: string | undefined;\n  categoryId?: string | undefined;\n  mapping: GiscusMapping;\n  term?: string | undefined;\n  theme?: GiscusTheme | undefined;\n  reactionsEnabled?: BooleanString | undefined;\n  strict?: BooleanString | undefined;\n  emitMetadata?: BooleanString | undefined;\n  inputPosition?: GiscusInputPosition | undefined;\n  lang?: GiscusLang | undefined;\n  loading?: GiscusLoading | undefined;\n}\n\nexport default defineComponent({\n  name: \"GiscusComment\",\n\n  props: {\n    /**\n     * The path of the comment\n     */\n    identifier: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Whether the component is in darkmode\n     *\n     * 组件是否处于夜间模式\n     */\n    darkmode: Boolean,\n  },\n\n  setup(props) {\n    const giscusOptions = useGiscusOptions();\n    const lang = usePageLang();\n\n    const enableGiscus = Boolean(\n      giscusOptions.repo &&\n        giscusOptions.repoId &&\n        giscusOptions.category &&\n        giscusOptions.categoryId,\n    );\n\n    const { repo, repoId, category, categoryId } = giscusOptions;\n\n    const loaded = ref(false);\n\n    const giscusLang = computed(() => {\n      if (SUPPORTED_LANGUAGES.includes(<GiscusLang>lang.value))\n        return lang.value;\n\n      const shortCode = lang.value.split(\"-\")[0] as GiscusLang;\n\n      if (SUPPORTED_LANGUAGES.includes(shortCode)) return shortCode;\n\n      return \"en\";\n    });\n\n    const config = computed(\n      () =>\n        <GiscusProps>{\n          repo,\n          repoId,\n          category,\n          categoryId,\n          lang: giscusLang.value,\n          theme: props.darkmode\n            ? giscusOptions.darkTheme || \"dark\"\n            : giscusOptions.lightTheme || \"light\",\n          mapping: giscusOptions.mapping || \"pathname\",\n          term: props.identifier,\n          inputPosition: giscusOptions.inputPosition || \"top\",\n          reactionsEnabled:\n            giscusOptions.reactionsEnabled === false ? \"0\" : \"1\",\n          strict: giscusOptions.strict === false ? \"0\" : \"1\",\n          loading: giscusOptions.lazyLoading === false ? \"eager\" : \"lazy\",\n          emitMetadata: \"0\",\n        },\n    );\n\n    onMounted(async () => {\n      await import(/* webpackChunkName: \"giscus\" */ \"giscus\");\n      loaded.value = true;\n    });\n\n    return (): VNode | null =>\n      enableGiscus\n        ? h(\n            \"div\",\n            {\n              id: \"comment\",\n              class: [\n                \"giscus-wrapper\",\n                { \"input-top\": giscusOptions.inputPosition !== \"bottom\" },\n              ],\n            },\n            loaded.value ? h(\"giscus-widget\", config.value) : h(LoadingIcon),\n          )\n        : null;\n  },\n});\n"],"names":["SUPPORTED_LANGUAGES","defineComponent","props","giscusOptions","useGiscusOptions","lang","usePageLang","enableGiscus","repo","repoId","category","categoryId","loaded","ref","giscusLang","computed","shortCode","config","onMounted","h","LoadingIcon"],"mappings":"6PAgBA,MAAMA,EAAsB,CAC1B,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,QACA,OACF,EAyBA,MAAeC,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAIL,WAAY,CACV,KAAM,OACN,SAAU,EACZ,EAOA,SAAU,OACZ,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAgBC,EAAAA,EAChBC,EAAOC,EAAY,EAEnBC,EAAe,CAAA,EACnBJ,EAAc,MACZA,EAAc,QACdA,EAAc,UACdA,EAAc,YAGZ,CAAE,KAAAK,EAAM,OAAAC,EAAQ,SAAAC,EAAU,WAAAC,CAAW,EAAIR,EAEzCS,EAASC,EAAI,EAAK,EAElBC,EAAaC,EAAS,IAAM,CAChC,GAAIf,EAAoB,SAAqBK,EAAK,KAAK,EACrD,OAAOA,EAAK,MAEd,MAAMW,EAAYX,EAAK,MAAM,MAAM,GAAG,EAAE,CAAC,EAEzC,OAAIL,EAAoB,SAASgB,CAAS,EAAUA,EAE7C,IACT,CAAC,EAEKC,EAASF,EACb,KACe,CACX,KAAAP,EACA,OAAAC,EACA,SAAAC,EACA,WAAAC,EACA,KAAMG,EAAW,MACjB,MAAOZ,EAAM,SACTC,EAAc,WAAa,OAC3BA,EAAc,YAAc,QAChC,QAASA,EAAc,SAAW,WAClC,KAAMD,EAAM,WACZ,cAAeC,EAAc,eAAiB,MAC9C,iBACEA,EAAc,mBAAqB,GAAQ,IAAM,IACnD,OAAQA,EAAc,SAAW,GAAQ,IAAM,IAC/C,QAASA,EAAc,cAAgB,GAAQ,QAAU,OACzD,aAAc,GAChB,EACJ,EAEA,OAAAe,EAAU,SAAY,CACpB,KAA8C,QAAA,QAAQ,EACtDN,EAAO,MAAQ,EACjB,CAAC,EAEM,IACLL,EACIY,EACE,MACA,CACE,GAAI,UACJ,MAAO,CACL,iBACA,CAAE,YAAahB,EAAc,gBAAkB,QAAS,CAC1D,CACF,EACAS,EAAO,MAAQO,EAAE,gBAAiBF,EAAO,KAAK,EAAIE,EAAEC,CAAW,CACjE,EACA,IACR,CACF,CAAC"}